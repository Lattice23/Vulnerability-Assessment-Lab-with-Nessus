# Vulnerability-Assessment-Lab-with-Nessus
![](https://github.com/Lattice23/Vulnerability-Assessment-Lab-with-Nessus/assets/159420767/ad4cbda2-4061-4c49-9657-4a787246aed6)

## Introduction

Vulnerability management plays a crucial role in cybersecurity. It helps organizations identify, assess, and mitigate vulnerabilities in their systems and networks. I will be demonstrating how to do that with Nessus. Nessus is an open-source widely used vulnerability scanning tool that is highly effective. It allows organizations to conduct comprehensive vulnerability assessments by scanning networks, systems, and applications for known vulnerabilities while providing detailed reports.

## Objective

By following this guide, others learning cybersecurity like myself will be able to set up their own vulnerability management lab using Nessus, gaining valuable experience in identifying and mitigating vulnerabilities in a controlled environment. This hands-on practice will enhance their understanding of cybersecurity and equip them with the skills needed to secure systems and networks effectively.

# Requirements 

- VMware Workstation Player [link](https://www.vmware.com/content/vmware/vmware-published-sites/us/products/workstation-player.html.html)
- 1 x Windows 10 ISO file [Link](https://www.microsoft.com/en-us/software-download/windows10)
- Nessus Essentials [Link](https://www.tenable.com/products/nessus/nessus-essentials)

# Nessus setup
1. Fill out the [registration](https://www.tenable.com/products/nessus/nessus-essentials) form to acquire an activation code in your email.
2. Go to the email and click on download Nessus
3. After the installation, a web interface will appear on your browser.
4. Connect via SSL then click advanced and continue after getting a warning from the browser.
5.  Select Nessus Essentials
6.  Press skip and proceed to enter your activation code.
7.  Create a User account and login
# Troubleshooting 
Lost the Nessus web URL?
(The web interface runs on your loopback address on port 8834. Using this in the search bar should fix the issue “https://127.0.0.1:8834”.)

# VMware setup
1. Go to player and select file to create a new virtual machine.
2. Select the ISO file for the installer disc image.
3. In VM Settings, set the network to NAT or Bridged. (change CPU cores and memory depending on how fast you want the VM to be)
4. Power on the virtual machine after creation.
5. Start the virtual machine and quickly press any key to enter setup mode.
6. Select “I don’t have a product key” and select Windows 10 Home.
7. Choose “Custom install” and select the unallocated space for installation.
8. Follow the on-screen instructions to complete the installation
# Troubleshooting connectivity
After setting up your VM you will need to open up the command prompt to check if there is any connectivity by using the command “ipconfig”. After getting the IP of the VM go ahead and ping it from your host machine. If you receive a message saying “Request Timed out” go into your VM’s Windows Defender Firewall > Windows Defender Firewall Properties > Disable “Firewall state” on every profile.

# Nessus scanning
Once you start Nessus you will want to select a new scan. just starting out all we need is a basic network scan. You can also check out all the other types of scans too.
Choose a name for your scan and enter the IP address of the VM as a target. After saving, launch your scan and Nessus will start adding any info or vulnerabilities it finds on the VM.
![](https://github.com/Lattice23/Vulnerability-Assessment-Lab-with-Nessus/assets/159420767/b6563031-d6c5-47cc-98ae-10e12bfef88d)

Choose a name for your scan and enter the IP address of the VM as a target. After saving, launch your scan and Nessus will start adding any info or vulnerabilities it finds on the VM

![](https://github.com/Lattice23/Vulnerability-Assessment-Lab-with-Nessus/assets/159420767/e823b278-01cf-46f1-bf8e-bec598ead84d)
# Credentialed scans
We can also run a credentialed scan on the VM. A credentialed scan can quickly determine which systems are out of date on patch installation compared to a non-credentialed scan like we just did. This is especially important when a new vulnerability is made public and executive management wants a quick answer regarding the impact to the organization.

# Prerequisites
We first need to disable any security policies in the way on the VM

1. The Windows Management Instrumentation (WMI) service must be enabled on the target.
2. The Remote Registry service must be enabled on the target.
3. File and printer Sharing must be enabled in the target’s network configuration.
4. In your Windows search box enter, UAC and turn it down to never notify
5. On the VM, go to the search box and enter “regedit”
6. Follow the path to this registry subkey: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\system\LocalAccountTokenFilterPolicy
7. Modify the value data to 1
8. Restart your VM
# Troubleshooting
(If the LocalAccountTokenFilterPolicy registry entry does not exist you will need to create a new one using DWORD (32-bit) Value and modify the value data to 1)

#Starting the scan
1. Just like previously we will go to Nessus and create a new basic network scan
2. Go to the credentials tab and select Windows
3. Set the authentication method to password and enter your VM credentials
4. Hit save and launch the scan
   
![](https://github.com/Lattice23/Vulnerability-Assessment-Lab-with-Nessus/assets/159420767/de8b573c-e529-4b3e-91f1-da85a857cc94)
As you can see compared to the non-credentialed scan this scan found over 10 high vulnerabilities and 6 critical. This shows that a credentialed scan provides more accurate and detailed information about the vulnerabilities present in the VM. It allows you to assess the actual security posture of the system by identifying missing patches and misconfiguration.

# Remediation
It's time to remediate the vulnerabilities.

By clicking on the vulnerabilities tab you can see the vulnerabilities are sorted by severity

![](https://github.com/Lattice23/Vulnerability-Assessment-Lab-with-Nessus/assets/159420767/ee16d301-4823-4804-bd59-268672a45887)

We can look through these to check some of the critical vulnerabilities including outdated software versions and misconfigurations. To remediate these vulnerabilities, it is important to update the software to the latest versions and configure the systems according to security best practices.

Let's run one last Credentialed scan after updating multiple applications and the machine.

![](https://github.com/Lattice23/Vulnerability-Assessment-Lab-with-Nessus/assets/159420767/a5a7d433-974f-466c-b114-ac9436b4f70e)  ![](https://github.com/Lattice23/Vulnerability-Assessment-Lab-with-Nessus/assets/159420767/95e30524-ed95-4493-8f40-7a181c3e23a2)

As you can see, the number of high vulnerabilities has been reduced by half, and the number of critical vulnerabilities has decreased to 1 with just simple fixes.

# Extras
First off I want to give a big S/O to Josh Madakor for the vulnerability assessment resources.
For extra practice with Nessus, you can add known vulnerabilities like old applications or malware if you’re feeling bold. This will help improve your remediation process and understand how to prioritize and address different types of vulnerabilities. Additionally, you can explore advanced features of Nessus such as compliance scanning and integration with other security tools. This will further enhance your skills and knowledge in vulnerability management. Happy scanning!











 









